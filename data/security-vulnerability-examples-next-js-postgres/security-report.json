{
  "totalRoutes": 7,
  "routesWithSinks": 6,
  "routesWithoutAuth": 1,
  "vulnerableRoutes": [
    {
      "route": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\vulnerable-1\\route.ts",
      "methods": [
        "GET"
      ],
      "vulnerability": "Missing Authorization for unpublished_blog_access",
      "severity": "high",
      "description": "GET handler uses unpublished_blog_access with authentication but without proper authorization checks (role or ownership validation)"
    },
    {
      "route": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\solution-2\\route.ts",
      "methods": [
        "GET"
      ],
      "vulnerability": "Missing Authorization for unpublished_blog_access",
      "severity": "high",
      "description": "GET handler uses unpublished_blog_access with authentication but without proper authorization checks (role or ownership validation)"
    },
    {
      "route": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\solution-1\\route.ts",
      "methods": [
        "GET"
      ],
      "vulnerability": "Missing Authorization for unpublished_blog_access",
      "severity": "high",
      "description": "GET handler uses unpublished_blog_access with authentication but without proper authorization checks (role or ownership validation)"
    },
    {
      "route": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-1-missing-authentication-route-handler\\vulnerable\\route.ts",
      "methods": [
        "GET"
      ],
      "vulnerability": "Insecure published_blog_access",
      "severity": "medium",
      "description": "GET handler uses published_blog_access without authentication checks"
    }
  ],
  "routes": [
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-5-secrets-exposure\\solution-2\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 16",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 18",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 29",
          "details": "const user = await getUserByValidSessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 16",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 18",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 29",
              "details": "const user = await getUserByValidSessionToken(sessionToken);"
            }
          ]
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\vulnerable-1\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "unpublished_blog_access",
          "location": "Line 43",
          "callPath": [
            "getUnpublishedBlogPosts"
          ],
          "customSeverity": "high"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 17",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 19",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 30",
          "details": "const user = await getUserByValidSessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "unpublished_blog_access",
              "location": "Line 43",
              "callPath": [
                "getUnpublishedBlogPosts"
              ],
              "customSeverity": "high",
              "isProtected": true
            }
          ],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 17",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 19",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 30",
              "details": "const user = await getUserByValidSessionToken(sessionToken);"
            }
          ]
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\solution-2\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "unpublished_blog_access",
          "location": "Line 43",
          "callPath": [
            "getUnpublishedBlogPostsByUserId"
          ],
          "customSeverity": "high"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 17",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 19",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 30",
          "details": "const user = await getUserByValidSessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "unpublished_blog_access",
              "location": "Line 43",
              "callPath": [
                "getUnpublishedBlogPostsByUserId"
              ],
              "customSeverity": "high",
              "isProtected": true
            }
          ],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 17",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 19",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 30",
              "details": "const user = await getUserByValidSessionToken(sessionToken);"
            }
          ]
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-3-missing-authorization-route-handler\\solution-1\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "unpublished_blog_access",
          "location": "Line 29",
          "callPath": [
            "getUnpublishedBlogPostsBySessionToken"
          ],
          "customSeverity": "high"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 16",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 18",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 29",
          "details": "const blogPosts = await getUnpublishedBlogPostsBySessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "unpublished_blog_access",
              "location": "Line 29",
              "callPath": [
                "getUnpublishedBlogPostsBySessionToken"
              ],
              "customSeverity": "high",
              "isProtected": true
            }
          ],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 16",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 18",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 29",
              "details": "const blogPosts = await getUnpublishedBlogPostsBySessionToken(sessionToken);"
            }
          ]
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-1-missing-authentication-route-handler\\vulnerable\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "published_blog_access",
          "location": "Line 16",
          "callPath": [
            "getPublishedBlogPosts"
          ],
          "customSeverity": "medium"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "published_blog_access",
              "location": "Line 16",
              "callPath": [
                "getPublishedBlogPosts"
              ],
              "customSeverity": "medium",
              "isProtected": false
            }
          ],
          "hasAuthentication": false,
          "authorizationChecks": []
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-1-missing-authentication-route-handler\\solution-2\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "published_blog_access",
          "location": "Line 43",
          "callPath": [
            "getPublishedBlogPosts"
          ],
          "customSeverity": "medium"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 17",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 19",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 30",
          "details": "const user = await getUserByValidSessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "published_blog_access",
              "location": "Line 43",
              "callPath": [
                "getPublishedBlogPosts"
              ],
              "customSeverity": "medium",
              "isProtected": true
            }
          ],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 17",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 19",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 30",
              "details": "const user = await getUserByValidSessionToken(sessionToken);"
            }
          ]
        }
      ]
    },
    {
      "filePath": "data\\security-vulnerability-examples-next-js-postgres\\app\\api\\example-1-missing-authentication-route-handler\\solution-1\\route.ts",
      "method": [
        "GET"
      ],
      "sinks": [
        {
          "type": "published_blog_access",
          "location": "Line 29",
          "callPath": [
            "getPublishedBlogPostsBySessionToken"
          ],
          "customSeverity": "medium"
        }
      ],
      "hasAuthentication": false,
      "authorizationChecks": [
        {
          "type": "session_check",
          "location": "Line 16",
          "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
        },
        {
          "type": "session_check",
          "location": "Line 18",
          "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
        },
        {
          "type": "session_check",
          "location": "Line 29",
          "details": "const blogPosts = await getPublishedBlogPostsBySessionToken(sessionToken);"
        }
      ],
      "parameters": [],
      "middleware": [],
      "methodDetails": [
        {
          "method": "GET",
          "sinks": [
            {
              "type": "published_blog_access",
              "location": "Line 29",
              "callPath": [
                "getPublishedBlogPostsBySessionToken"
              ],
              "customSeverity": "medium",
              "isProtected": true
            }
          ],
          "hasAuthentication": true,
          "authorizationChecks": [
            {
              "type": "session_check",
              "location": "Line 16",
              "details": "const sessionToken = request.cookies.get('sessionToken')?.value;"
            },
            {
              "type": "session_check",
              "location": "Line 18",
              "details": "if (!sessionToken) {\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Session token not prov"
            },
            {
              "type": "session_check",
              "location": "Line 29",
              "details": "const blogPosts = await getPublishedBlogPostsBySessionToken(sessionToken);"
            }
          ]
        }
      ]
    }
  ]
}